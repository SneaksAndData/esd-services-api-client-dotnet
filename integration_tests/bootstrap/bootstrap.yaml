---
apiVersion: auth.sneaksanddata.com/v1beta1
kind: IdentityProviderDocument
metadata:
  labels:
    application/boxer-issuer: integration-tests
  name: keycloak
  namespace: default
spec:
  active: true
  oidc:
    audiences:
      - account
    discoveryUrl: http://keycloak-keycloakx-http/auth/realms/master/
    issuers:
      - http://localhost:5555/auth/realms/master
    userIdClaim: preferred_username
---
apiVersion: auth.sneaksanddata.com/v1beta1
kind: ExternalIdentityDocument
metadata:
  labels:
    application/boxer-issuer: integration-tests
  name: keycloak-test-root
  namespace: default
spec:
  active: true
  id: test_root
  identityProvider: keycloak
  principalRef:
    principal: PhotoApp::User::"root"
    schema: root-issuer
  validatorSchemaId: integration-test-validator
---
apiVersion: auth.sneaksanddata.com/v1beta1
kind: CedarEntityDocument
metadata:
  labels:
    application/boxer-issuer: integration-tests
  name: root-issuer-root-photoapp
  namespace: default
spec:
  active: true
  entity: |
    {
      "uid": {
        "type": "PhotoApp::User",
        "id": "root"
      },
      "attrs": {
      },
      "parents": []
    }
---
apiVersion: auth.sneaksanddata.com/v1beta1
kind: SchemaDocument
metadata:
  labels:
    application/boxer-issuer: integration-tests
  name: root-issuer
  namespace: default
spec:
  active: true
  schema: |
    {
      "PhotoApp": {
        "commonTypes": {},
        "entityTypes": {
          "User": {
            "shape": {
              "type": "Record",
              "attributes": {}
            }
          }
        },
        "actions": {}
      }
    }
